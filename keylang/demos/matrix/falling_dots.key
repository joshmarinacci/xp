@board("matrix")

//the screen is already allocated
let palette = range(10).map((v) => { Color(hue:remap(v,0,10, 0,1),sat:0.5,lit:0.5) })
let dots
let sorigin = [0,0]

//call this once at app start
@type("start",setup)
fun setup() {
    fun MakeDot() {
        let dot = Obj()
        dot.xy = Point(randi(0,screen.width), randi(0,1))
        dot.v =  Vector(randf(-0.15,0.15), randf(0.25,0.9))
        dot.color = choose(palette)
        return dot
    }
    dots = range(20).map(()=> { MakeDot()})
}

// call this every one second
@type("loop",loop)
fun loop() {
    dots.every((dot) => {
        dot.xy = wrap(dot.xy + dot.v, sorigin, screen.size)
        screen.setPixel(dot.xy,dot.color)
    })
}

